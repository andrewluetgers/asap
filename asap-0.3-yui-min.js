/* asap script loading library
 * MIT License: http://en.wikipedia.org/wiki/MIT_License
 * version:	0.3 - 3/26/2010
 * author: andrew dot luetgers at gmail
 */ 

asap=(function(){bindReady=function(){if(API.readyBound){return;}API.readyBound=true;if(document.readyState==="complete"){return ready();}if(document.addEventListener){document.addEventListener("DOMContentLoaded",a,false);window.addEventListener("load",API.ready,false);}else{if(document.attachEvent){document.attachEvent("onreadystatechange",a);window.attachEvent("onload",API.ready);var x=false;try{x=window.frameElement===null;}catch(y){}if(document.documentElement.doScroll&&x){API.doScrollCheck();}}}},API={isReady:false,readyBound:false,readyList:[],DOMContentLoaded:false,getVersion:function(){return version;},doScrollCheck:function(){if(API.isReady){return;}try{document.documentElement.doScroll("left");}catch(x){setTimeout(API.doScrollCheck,1);return;}API.ready();},ready:function(){if(!API.isReady){if(!document.body){return setTimeout(API.ready,13);}API.isReady=true;if(API.readyList){var y,x=0;while((y=API.readyList[x++])){y();}API.readyList=null;}}},domReady:function(x){bindReady();if(this.isReady){x();}else{if(this.readyList){this.readyList.push(x);}}return this;},codeReadyList:[],isCodeReady:false,codeReadyQued:false,codeReady:function(z){if(typeof z=="function"){this.codeReadyList.push(z);}else{if(this.require.scriptQue.length===0&&!this.isCodeReady){if(!this.isReady&&!this.codeReadyQued){this.codeReadyQued=true;this.domReady(function(){API.codeReady();});}else{this.isCodeReady=true;if(this.codeReadyList){var x,y=0;while((x=this.codeReadyList[y++])){x();}this.codeReadyList=null;}}}}return this;}};var a,q,r;if(document.addEventListener){a=function(){document.removeEventListener("DOMContentLoaded",a,false);API.ready();};}else{if(document.attachEvent){a=function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",a);API.ready();}};}}if(window.XMLHttpRequest&&(window.location.protocol!=="file:"||!window.ActiveXObject)){q=function(){return new window.XMLHttpRequest();};}else{q=function(){try{return new window.ActiveXObject("Microsoft.XMLHTTP");}catch(x){}};}API.get=function(y){var C=q(),x=y.url||false,B=y.onSuccess||false,z=y.onError||false;if(!C||!x||!B||!z){return;}C.open("GET",x,true);C.onreadystatechange=function(){if(C.readyState==4){if((window.location.protocol=="file:"||C.status==200)&&(C.responseText&&B)){B(C.responseText);}else{if(z){z(C.status);}}}};try{C.send("");}catch(A){if(z){z(A);}}return C;};var m=[],l={},d=/[a-z0-9\-\.]+\.[a-z]{2,3}$/i,h=/^http:/i,j=/^http:|file:/i,v=d.exec(window.location.host),k="",p=0,w=0,e=0,f=document.getElementsByTagName("head")[0],b=function(y){var x=h.exec(y);var z=window.location.protocol;if(x===null){return true;}if(z=="file:"){return false;}if(x[0]==z){if(y.match(v)){return true;}}return false;},o=function(){var y,x;if((y=m[0])&&(x=l[y])){if(x.status=="loaded"){x.status="parsing";c(x.response+" ;(asap.require.evalComplete('"+y+"'));");}}},n=function(y){var x;if(m[0]==y&&(x=l[y])&&x.status=="parsing"){x.status="loaded";w++;m.splice(0,1);x.response="already evaled";if(m.length){o();}else{if(w==p){API.codeReady();}}}else{}},u=function(y){var x;if(x=l[y]){x.status="loading";i(y,function(){l[y].status="parsing";asap.require.evalComplete(y);},function(){throw new Error("asap.loadScript ERROR unable to load "+y);});}},i=function(y,A,z){var x=document.createElement("script");x.type="text/javascript";if(x.readyState){x.onreadystatechange=function(){if(x.readyState=="loaded"||x.readyState=="complete"){x.onreadystatechange=null;A();}};}else{x.onload=function(){A();};}x.onerror=function(){z();};x.src=y;f.appendChild(x);},s=(function(){var x=document.documentElement,y=document.createElement("script"),B="script"+new Date().getTime(),z=false;y.type="text/javascript";try{y.appendChild(document.createTextNode("window."+B+"=1;"));}catch(A){}x.insertBefore(y,x.firstChild);if(window[B]){delete window[B];z=true;}x.removeChild(y);return z;}()),c=function(z){var y=f||document.documentElement,x=document.createElement("script");x.type="text/javascript";if(s){x.appendChild(document.createTextNode(z));}else{x.text=z;}y.insertBefore(x,y.firstChild);y.removeChild(x);},t=function(x){var y=document.createElement("link");y.rel="stylesheet";y.type="text/css";y.href=x;f.appendChild(y);},g=function(C){var A,x,B,y;if(typeof C=="object"){A=C.files||C;p=x=A.length||0;B="";k=C.scriptRoot||k;for(var z=0;z<x;z++){asap.require(A[e]);}return this;}if(j.exec(C)){B=C;}else{B=k+C;}if(!l[B]){m.push(B);y=l[B]={status:"qued",xhr:false,response:false};e++;if(!b(B)){u(B);return this;}y.xhr=asap.get({url:B,onSuccess:function(D){var E=l[B];E.status="loaded";E.response=D;E.xhr=false;if(m[0]==B){o();}},onError:function(D){var E=l[B];if(typeof D=="object"&&message in D){throw new Error("asap.get ERROR: "+D[message]+" on "+B);}else{if(D!==404){u(B);}else{throw new Error("asap.get ERROR: loading external resource: status code: "+D+" on "+B);}}}});}else{throw new Error("ERROR asap.loadScript requires a string!");}return this;};API.domReady(o);API.require=g;API.require.evalComplete=n;API.require.scriptQue=m;return API;}());
