/* asap script loading library
 * MIT License: http://en.wikipedia.org/wiki/MIT_License
 * version:	0.3 - 4/9/2010
 * author: andrew dot luetgers at gmail
 */

asap=(function(){bindReady=function(){if(API.readyBound){return;}API.readyBound=true;if(document.readyState==="complete"){return ready();}if(document.addEventListener){document.addEventListener("DOMContentLoaded",a,false);window.addEventListener("load",API.ready,false);}else{if(document.attachEvent){document.attachEvent("onreadystatechange",a);window.attachEvent("onload",API.ready);var w=false;try{w=window.frameElement===null;}catch(x){}if(document.documentElement.doScroll&&w){API.doScrollCheck();}}}},API={isReady:false,readyBound:false,readyList:[],DOMContentLoaded:false,getVersion:function(){return version;},doScrollCheck:function(){if(API.isReady){return;}try{document.documentElement.doScroll("left");}catch(w){setTimeout(API.doScrollCheck,1);return;}API.ready();},ready:function(){if(!API.isReady){if(!document.body){return setTimeout(API.ready,13);}API.isReady=true;if(API.readyList){var x,w=0;while((x=API.readyList[w++])){x();}API.readyList=null;}}},domReady:function(w){bindReady();if(this.isReady){w();}else{if(this.readyList){this.readyList.push(w);}}return this;},codeReadyList:[],isCodeReady:false,codeReadyQued:false,codeReady:function(y){if(typeof y=="function"){this.codeReadyList.push(y);}else{if(this.require.scriptQue.length===0&&!this.isCodeReady){if(!this.isReady&&!this.codeReadyQued){this.codeReadyQued=true;this.domReady(function(){API.codeReady();});}else{this.isCodeReady=true;if(this.codeReadyList){var w,x=0;while((w=this.codeReadyList[x++])){w();}this.codeReadyList=null;}}}}return this;}};var a,p,q;if(document.addEventListener){a=function(){document.removeEventListener("DOMContentLoaded",a,false);API.ready();};}else{if(document.attachEvent){a=function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",a);API.ready();}};}}if(window.XMLHttpRequest&&(window.location.protocol!=="file:"||!window.ActiveXObject)){p=function(){return new window.XMLHttpRequest();};}else{p=function(){try{return new window.ActiveXObject("Microsoft.XMLHTTP");}catch(w){}};}API.get=function(x){var B=p(),w=x.url||false,A=x.onSuccess||false,y=x.onError||false;if(!B||!w||!A||!y){return;}B.open("GET",w,true);B.onreadystatechange=function(){if(B.readyState==4){if((window.location.protocol=="file:"||B.status==200)&&(B.responseText&&A)){A(B.responseText);}else{if(y){y(B.status);}}}};try{B.send("");}catch(z){if(y){y(z);}}return B;};var l=[],k={},d=/[a-z0-9\-\.]+\.[a-z]{2,3}$/i,g=/^http:/i,i=/^http:|file:/i,t=d.exec(window.location.host),j="",o=0,u=0,e=0,b=function(x){var w=g.exec(x);var y=window.location.protocol;if(w===null){return true;}if(y=="file:"){return false;}if(w[0]==y){if(x.match(t)){return true;}}return false;},n=function(){var x,w;if((x=l[0])&&(w=k[x])){if(w.status=="loaded"){w.status="parsing";c(w.response+" ; (asap.require.evalComplete('"+x+"'));");}}},m=function(x){var w;if(l[0]==x&&(w=k[x])&&(w.status=="parsing"||w.status=="loaded")){w.status="loaded";u++;l.splice(0,1);w.response="already evaled";if(l.length){n();}else{if(u==o){API.codeReady();}}}else{}},v=function(x){var w;if(w=k[x]){w.status="loading";h(x,function(){k[x].status="loaded";asap.require.evalComplete(x);},function(){throw new Error("asap.loadScript ERROR unable to load "+x);});}},h=function(x,A,z){var y=document.getElementsByTagName("head")[0]||document.documentElement,w=document.createElement("script");w.type="text/javascript";w.charset="utf-8";if(w.readyState){w.onreadystatechange=function(){if(w.readyState=="loaded"||w.readyState=="complete"){w.onreadystatechange=null;A();}};}else{w.onload=function(){A();};}w.onerror=function(){z();};w.src=x;y.appendChild(w);},r=(function(){var w=document.getElementsByTagName("head")[0]||document.documentElement,x=document.createElement("script"),A="script"+new Date().getTime(),y=false;x.type="text/javascript";try{x.appendChild(document.createTextNode("window."+A+"=1;"));}catch(z){}w.insertBefore(x,w.firstChild);if(window[A]){delete window[A];y=true;}w.removeChild(x);return y;}()),c=function(x){var y=document.getElementsByTagName("head")[0]||document.documentElement,w=document.createElement("script");w.type="text/javascript";if(r){w.appendChild(document.createTextNode(x));}else{w.text=x;}y.insertBefore(w,y.firstChild);y.removeChild(w);},s=function(w){var y=document.getElementsByTagName("head")[0]||document.documentElement,x=document.createElement("link");x.rel="stylesheet";x.type="text/css";x.href=w;y.appendChild(x);},f=function(D,x){var B,w,C,z;if(typeof D=="object"){B=D.files||D;o=w=B.length||0;debug=D.debug||x||window.location.href.match("asap=debug");C="";j=D.root||j;for(var A=0;A<w;A++){var y=B[e];if(typeof y=="object"&&y.length==1&&typeof y[0]=="string"){asap.require(y[0],true);}else{asap.require(B[e],debug);}}return this;}if(i.exec(D)){C=D;}else{C=j+D;}if(!k[C]){l.push(C);z=k[C]={status:"qued",xhr:false,response:false};e++;if(!b(C)||x){v(C);return this;}z.xhr=asap.get({url:C,onSuccess:function(E){var F=k[C];if(E){F.status="loaded";}F.response=E;F.xhr=false;if(l[0]==C){n();}},onError:function(E){var F=k[C];if(typeof E=="object"&&message in E){F.status="ERROR";throw new Error("asap.get ERROR: "+E[message]+" on "+C);}else{if(E!==404){v(C);}else{F.status="ERROR";throw new Error("asap.get ERROR: loading external resource: status code: "+E+" on "+C);}}}});}else{throw new Error("ERROR asap.loadScript requires a string!");}return this;};API.domReady(n);API.require=f;API.require.evalComplete=m;API.require.scriptQue=l;return API;}());